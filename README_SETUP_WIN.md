# ChatGPT LightWeight Terminal (CLWT) Windowsセットアップガイド

このガイドでは、Windows環境でChatGPT LightWeight Terminal (CLWT)をセットアップし、実行するための手順を詳細に説明します。

## 1. 前提条件: 必要なソフトウェアのインストール（重要）

CLWTを実行するには、以下のソフトウェアが必要です。まだインストールしていない場合は、手順に従ってインストールしてください。

### 1-1. Pythonのインストール
CLWTはPythonで動作するため、Python環境が必須です。

1.  **Python公式サイトへアクセス**
    - [https://www.python.org/downloads/](https://www.python.org/downloads/) にアクセスし、最新のPythonインストーラー（Python 3.8以上推奨）をダウンロードしてください。

2.  **インストーラーの実行と設定**
    - ダウンロードしたインストーラーを実行します。
    - **【最重要】** インストール画面の下部にある **"Add Python to PATH" (Pythonを環境変数PATHに追加する)** のチェックボックスを**必ずオンにしてください**。
    - これを行わないと、セットアップスクリプトやアプリケーションがPythonを見つけられず、エラーになります。

3.  **インストールの完了**
    - "Install Now" をクリックしてインストールを完了させます。

### 1-2. Microsoft Visual C++ 再頒布可能パッケージのインストール
Playwrightなどのライブラリが動作するために、Microsoft Visual C++ 再頒布可能パッケージが必要な場合があります。
多くのWindows環境には既にインストールされていますが、もし実行時にエラー（DLLが見つからない等）が発生する場合は、以下のリンクから最新の「Visual Studio 2015, 2017, 2019, and 2022」用のインストーラー（vc_redist.x64.exe）をダウンロードし、インストールしてください。
- [Microsoft 公式ダウンロードページ](https://learn.microsoft.com/ja-jp/cpp/windows/latest-supported-vc-redist?view=msvc-170)

## 2. セットアップスクリプトの実行

前提条件のインストールが完了したら、付属のセットアップスクリプトを使用して環境を構築します。このスクリプトは以下の処理を自動で行います。
- 必要なフォルダの作成 (`applog`, `tmp1`, `log1`)
- Python仮想環境 (`venv`) の作成
- 必要なライブラリ (`PyQt6`, `playwright`) のインストール
- Playwright用ブラウザ (Chromium) のインストール

### 手順

1.  **フォルダを開く**
    - エクスプローラーで `setup_clwt_env.bat` があるフォルダを開きます。

2.  **スクリプトの実行**
    - `setup_clwt_env.bat` をダブルクリックして実行します。
    - コマンドプロンプトが開き、セットアップが開始されます。

3.  **完了の確認**
    - 画面に `セットアップが完了しました！` と表示されたらセットアップは完了です。何かキーを押してウィンドウを閉じてください。

## 3. アプリケーションの起動

セットアップ完了後、以下の手順でアプリケーションを起動します。

### 方法A: コマンドプロンプトから起動

1.  コマンドプロンプト（またはPowerShell）を開き、CLWTのディレクトリに移動します。
2.  以下のコマンドを順番に実行します。

    ```cmd
    call venv\Scripts\activate
    python ChatgptLightWeightTerminal.py
    ```

### 方法B: 起動用バッチファイルを作成して起動

毎回コマンドを入力するのが面倒な場合は、以下の内容で `run_clwt.bat` というファイルを作成し、ダブルクリックで起動できるようにします。

1.  メモ帳などのテキストエディタを開きます。
2.  以下の内容をコピー＆ペーストします。

    ```bat
    @echo off
    cd /d "%~dp0"
    call venv\Scripts\activate.bat
    start pythonw ChatgptLightWeightTerminal.py
    ```

3.  ファイルを `run_clwt.bat` という名前で、`setup_clwt_env.bat` と同じフォルダに保存します。
4.  今後は `run_clwt.bat` をダブルクリックするだけで起動できます。

## トラブルシューティング

### Q1. "Python not found" (Pythonが見つかりません) というエラーが出る
**原因:** Pythonがインストールされていないか、環境変数PATHに追加されていません。
**対策:** 手順1-1の「Pythonのインストール」を見直し、**"Add Python to PATH"** にチェックを入れて再インストールしてください。インストール後はPCを再起動することをお勧めします。

### Q2. バッチファイルを実行すると一瞬で閉じてしまう、またはエラーメッセージが出る
**原因:** スクリプトの構文エラーや、古いバージョンのファイルが残っている可能性があります。
**対策:** `setup_clwt_env.bat` を最新のものに更新してください。また、テキストエディタで開いて、文字化けや不正な文字が含まれていないか確認してください。

### Q3. "ModuleNotFoundError" が出る
**原因:** 仮想環境が有効になっていないか、ライブラリのインストールに失敗しています。
**対策:** `setup_clwt_env.bat` を再実行してエラーが出ていないか確認してください。インターネット接続が安定していることも確認してください。

### Q4. Playwrightのブラウザが起動しない、またはDLLエラーが出る
**原因:** Visual C++ 再頒布可能パッケージが不足している可能性があります。
**対策:** 手順1-2を参照して、Microsoft Visual C++ 再頒布可能パッケージをインストールしてください。
